// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "mysql"
}

model Applicants {
  id                    String     @id @default(uuid())
  full_name             String
  email                 String     @unique
  phone                 String?
  country               String?
  job_title             String?
  unsubscribed          Boolean    @default(false)
  unsubscribedAt        DateTime?
  unsubscribedFromEmail String?
  emailLogs             EmailLogs[]
}

model EmailLogs {
  id                    String     @id @default(uuid())
  applicantId           String
  applicant             Applicants @relation(fields: [applicantId], references: [id], onDelete: Cascade)
  templateName          String
  sentAt                DateTime   @default(now())
  status                String     // 'success' | 'failed'
  errorMessage          String?    @db.Text
  emailSubject          String     @db.VarChar(500)
  emailBody             String     @db.Text
  retryCount            Int        @default(0)

  // Open Tracking Fields
  openedAt              DateTime?
  openCount             Int        @default(0)
  lastOpenedAt          DateTime?
  openedFromIp          String?
  openedFromUserAgent   String?    @db.Text

  // Click Tracking Fields
  clickedAt             DateTime?
  clickCount            Int        @default(0)
  lastClickedAt         DateTime?
  clickedUrl            String?
  clickedFromIp         String?
  clickedFromUserAgent  String?    @db.Text
}
